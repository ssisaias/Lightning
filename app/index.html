<!DOCTYPE html>
  <html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <title>Lightning</title>
  </head>
  <body>
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <div class="navbar-header" >
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Lightning</a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">        
          <ul class="nav navbar-nav">
            <li><a href="#/" onclick="openFile()"><span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span> Open </a></li>
            <li><a href="#/" onclick="saveFile()"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span> Save </a></li>
            <li><a href="#/">
            <span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span> 
            Projects</a></li>
            <li>
              <a href="#" type="button" data-toggle="modal" data-target="#newProjModal">
                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 
                New Project
              </a>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right projopt"></ul>
        </div>
      </div>
    </nav>
    <div class="view">
    	<div class="container" id="container"></div>
    </div>



























    <script id="template_viewprojects" type="x-tmpl-mustache">
      <div class="panel panel-primary">
        <div class="panel-heading">
          <h3 class="panel-title">Projects</h3>
        </div>
        <div class="panel-body">
          <table class="table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Description</th>
                <th>User Stories / Issues</th>
                <th>Progress</th>
              </tr>
            </thead>
            <tbody>

  
    var done = (value.getUSCount() / value.getUSDone()) * 100;
    
              <tr>
                <th><a href="#/project/'+value["id_project"]+'">'+value["name"]+'</a></th>
                <th>'+value["description"]+'</th>
                <th><span class="badge">'+value.getUSCount()+'</span> <span class="badge">'+value.getIssueCount()+'</span></th>
                <th><div class="progress"><div class="progress-bar" role="progressbar" aria-valuenow="'+done+'" aria-valuemin="0" 
    aria-valuemax="100" style="width: '+done+'%;">'+done+'%</div></div> </th>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </script>
  



    <script id="template_viewproject" type="x-tmpl-mustache">
      <table class="table">
          <caption>Lasts Sprint 
          <button class="btn btn-primary pull-right" type="submit" data-toggle="modal" data-target="#newSprintModal">New Sprint</button></caption> 
          <thead> <tr> <th>Sprint</th> <th>Points</th> <th>Time</th> </tr> </thead> <tbody> <tr> <td>Mark</td> <td><span class="badge">10</span></td> 
          <td>@mdo</td> </tr> <tr> \
          <td>Jacob</td> <td><span class="badge">10</span></td> <td>@fat</td> </tr> <tr> <td>Larry</td> <td><span class="badge">10</span></td> 
          <td>@twitter</td> </tr> </tbody> 
      </table>

      <div class="panel panel-primary"><div class="panel-heading">
        <h3 class="panel-title">'+project["name"]+'</h3></div><div class="panel-body">
  <div class="row"><div class="col-md-8">
  <div class="row">
  ht += '<div class="col-md-6"><div class="progress"><div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;">60%</div></div></div>
  ht += '<div class="col-md-3"><span class="badge">' + project.getUSPoints() + '</span> Defined Points </div>
  ht += '<div class="col-md-3"><span class="badge">' + project.getUSDone() + '</span> Closed Points </div>
  ht += '</div>
  ht += '<canvas id="myChart" width="200" height="200"></canvas></div>';
  ht += '<div class="col-md-4">'+sprints+'</div> </div></div></div>'

  <div class="row"><div class="col-md-8"><div class="panel panel-primary"> \
        <div class="panel-heading"> \
          <h3 class="panel-title">User Stories</h3> \
        </div> \
        <div class="panel-body"> \
          <button class="btn btn-primary pull-right" type="submit" data-toggle="modal" data-target="#newUSModal">New User Story</button> \
          <table class="table"> \
            <thead> \
              <tr> \
                <th>Story</th><th>Points</th><th>UX / Design / Front / Back</th><th>Status</th>\
              </tr> \
            </thead> \
            <tbody>';

  $.each(backlog, function( index, value ) {
    ht += '<tr><th><a href="#/project/'+project["id_project"]+'/story/'+value["id_us"]+'">'+value["subject"]+'</a></th>';
    ht += '<th>'+value.getPoints()+'</th><th>';
    ht += '<span class="badge">'+value["pt_ux"]+'</span> ';
    ht += '<span class="badge">'+value["pt_design"]+'</span> ';
    ht += '<span class="badge">'+value["pt_front"]+'</span> ';
    ht += '<span class="badge">'+value["pt_back"]+'</span></th>';
    ht += '<th>'+value["status"]+'</tr>';
  });

    </tbody></table></div></div></div><div class="col-md-4"><div class="panel panel-primary"><div class="panel-heading"><h3 class="panel-title">Sprint</h3></div><div class="panel-body">LOL</div></div></div>

    </script>






 var ht = '<div class="panel panel-primary"> ';
    ht += '    <div class="panel-heading"> '
    ht += '      <button type="button" class="btn btn-primary btn-xs pull-right">'
    ht += '      <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>'
    ht += '      Edit</button>'
    ht += '      <h3 class="panel-title">'+ story["subject"]+'</h3> \
      <input type="text" class="form-control" id="story" placeholder="Story" value="'+story["subject"]+'"> \
        </div> \
        <div class="panel-body">';

  ht += story["description"] + '<br><br><button type="button" class="btn btn-default btn-xs pull-right"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span> Edit</button><br><br>'; 

  ht += story.getPoints() + ' Total - ';
  ht += '<span class="badge">'+story["pt_ux"]+'</span> ';
  ht += '<span class="badge">'+story["pt_design"]+'</span> ';
  ht += '<span class="badge">'+story["pt_front"]+'</span> ';
  ht += '<span class="badge">'+story["pt_back"]+'</span>';
  ht += '<button type="button" class="btn btn-default btn-xs pull-right"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span> Edit</button><br>';

  ht += '<h2>Tasks</h2>';
  $.each(story.tasks, function( index, value ) {
    ht += '<p>'+value+'</p><br>';    
  });

  ht += '</div';

var project = new Project().findProject(id_project);
  var issues = new Issue().getIssues(project);

  ht = '<div class="panel panel-primary"><div class="panel-heading">'
  ht += '<h3 class="panel-title">Issues</h3></div><div class="panel-body">'
  ht += '<button class="btn btn-primary pull-right" data-toggle="modal" data-target="#newIssueModal">New Issue</button>'
  ht += '<table class="table"><thead><tr><th>Subject</th><th>Description</th>'
  ht += '<th>Type</th><th>Severity</th><th>Priority</th></tr></thead><tbody>';
  
  $.each(issues, function( index, value ) {
    ht += '<tr><th><a href="#/project/'+project["id_project"]+'/issues/'+value["id_issue"]+'">'+value["subject"]+'</a></th>';
    ht += '<th>'+value["description"]+'</th><th>'+value["type"]+'</th>';
    ht += '<th><span class="label label-danger">'+value["severity"]+'</span></th>';
    ht += '<th><span class="label label-danger">'+value["priority"]+'</span></th></tr>';
  });

  ht += '</tbody></table></div></div>';


  ht = '<div class="panel panel-primary">'+
        '<div class="panel-heading">'+
          '<h3 class="panel-title">'+issue["subject"]+'</h3>'+
        '</div>'+
        '<div class="panel-body">';

  ht += issue["description"]; 
  ht += '</div';


 ht = '<div id="sortableKanbanBoards" class="row">'

    $.each(tables, function( index, value ) {
    
      ht += ' <div class="panel panel-primary kanban-col"> \
                  <div class="panel-heading">' + value+ '<i class="fa fa-2x fa-plus-circle pull-right"></i></div> \
                  <div class="panel-body"> \
                    <div id="' + value + '" class="kanban-centered">'; 
                    
      $.each(stories, function( index_, story ) {
        if(story.status == value){
          ht += '<article class="kanban-entry grab" id="item_'+story["id_us"]+'" draggable="true"> \
                <div class="kanban-entry-inner"> \
                    <div class="kanban-label"> \
                      <h2>'+story["subject"]+'</h2> \
                      <p>'+story["description"]+'</p> \
                    </div> \
                </div> \
              </article> ';
        }
      });

      ht += '</div></div> \
                  <div class="panel-footer"><a href="#">Add a card...</a></div> \
              </div> \
          ';
    });

  ht += '</div>';

























<div class="modal fade" id="newUSModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <h4 class="modal-title" id="myModalLabel">New User Story</h4>
    </div>
    <div class="modal-body">
      <input type="text" class="form-control userstory" placeholder="User Story">
      <textarea class="form-control description" rows="3" placeholder="Description"></textarea>
      <div class="row"><div class="col-md-3">UX
        <select class="form-control uxpt">
          <option value="0">0</option><option value="0.5">0.5</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="5">5</option><option value="8">8</option><option value="13">13</option><option value="20">20</option><option value="40">40</option><option value="100">100</option></select>
      </div>
      <div class="col-md-3">Design
          <select class="form-control dpt">
            <option value="0">0</option>
            <option value="0.5">0.5</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="5">5</option>
            <option value="8">8</option>
            <option value="13">13</option>
            <option value="20">20</option>
            <option value="40">40</option>
            <option value="100">100</option>
          </select>
      </div>
      <div class="col-md-3">Frontend
        <select class="form-control fpt">
          <option value="0">0</option>
          <option value="0.5">0.5</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="5">5</option>
          <option value="8">8</option>
          <option value="13">13</option>
          <option value="20">20</option>
          <option value="40">40</option>
          <option value="100">100</option>
        </select>
      </div>
      <div class="col-md-3">Backend
      <select class="form-control bpt">
          <option value="0">0</option>
          <option value="0.5">0.5</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="5">5</option><option value="8">8</option><option value="13">13</option><option value="20">20</option><option value="40">40</option><option value="100">100</option>
        </select>
      </div>
    </div>Status
    <select class="form-control status">
      <option value="New">New</option><option value="Ready">Ready</option>
      <option value="In Progress">In Progress</option>
      <option value="Ready for test">Ready for test</option>
      <option value="Done">Done</option>
      <option value="Archived">Archived</option>
    </select>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-primary save_story">Create Story</button>
  </div>
</div>
</div></div>



    <div class="modal fade" id="newIssueModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="myModalLabel">New Issue</h4></div>
            <div class="modal-body">
              <input type="text" class="form-control issue" placeholder="Issue">
              <textarea class="form-control description" rows="3" placeholder="Description"></textarea>
              <div class="row"><br>
                <div class="col-md-3">
                  <select class="form-control type">
                    <option value="Bug">Bug</option>
                    <option value="Question">Question</option>
                    <option value="Enhancement">Enhancement</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <select class="form-control priority">
                    <option value="Low">Low</option>
                    <option value="Normal">Normal</option>
                    <option value="High">High</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <select class="form-control severity">
                    <option value="Wishlist">Wishlist</option>
                    <option value="Minor">Minor</option>
                    <option value="Normal">Normal</option>
                    <option value="Critical">Critical</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary save_issue">Create Story</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="newProjModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
              <h4 class="modal-title" id="myModalLabel">Novo Projeto</h4>
          </div>
          <div class="modal-body">
              <input type="text" class="p_name form-control" placeholder="Project Name">
              <textarea class="p_desc form-control" rows="3" placeholder="Description"></textarea>
          </div>
          <div class="modal-footer">
              <button type="button" class="btn btn-primary save_project">Create</button>
          </div>
        </div>
      </div>
    </div>



  </body>
    <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>

    <script src="libs/jquery.min.js" type="text/javascript"></script>
    <script src="libs/bootstrap.min.js" type="text/javascript"></script>
    <script src="libs/mustache.min.js" type="text/javascript"></script>
    <script src="libs/Chart.bundle.min.js" type="text/javascript"></script>
    <script src="lib/Chart.min.js" type="text/javascript"></script>
    <script src="libs/router.min.js" type="text/javascript"></script>
    <script src="app.js" type="text/javascript"></script>
    <script src="model.js" type="text/javascript"></script>
    <script src="view.js" type="text/javascript"></script>
    <script src="router.js" type="text/javascript"></script>
    <script src="event.js" type="text/javascript"></script>

    <script>if (window.module) module = window.module;</script>
</html>            